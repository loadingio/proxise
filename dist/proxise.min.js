(function(){var n,e;n=function(n,e,t){return n.splice(0,n.length).map(function(n){if(n[t](e),n.timeout)return clearTimeout(n.timeout)})},(e=function(e,t){var i,r,u,o,f;return i=e instanceof Function?[e,t||0]:[t,e||0],r=i[0],u=i[1],o=[],f=function(){var n,e,t,i,f,l,c;for(e=[],t=0,i=arguments.length;t<i;++t)e.push(arguments[t]);return n=e,(f=r.apply(this,n))instanceof Promise?f:(l=null,c=u?setTimeout(function(){var n;if(l&&~(n=o.indexOf(l)))return o.splice(n,1),l.rej(new Error("timeout"))},u):null,new Promise(function(n,e){return o.push(l={res:n,rej:e,timeout:c})}))},f.resolve=function(e){return n(o,e,"res")},f.reject=function(e){return n(o,e,"rej")},f}).once=function(n,t){var i,r;return i={},r=e(function(){if(i.inited)return Promise.resolve(null==t?i.val:"function"==typeof t?t():t);if(!i.initing)return i.initing=!0,Promise.resolve().then(function(){return n()}).finally(function(){return i.initing=!1}).then(function(n){return i.inited=!0,r.resolve(n=null==t?i.val=n:"function"==typeof t?t():t),n}).catch(function(n){return r.reject(n),Promise.reject(n)})})},"undefined"!=typeof module&&null!==module?module.exports=e:"undefined"!=typeof window&&null!==window&&(window.proxise=e)}).call(this);
